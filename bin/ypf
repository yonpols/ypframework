#!/usr/bin/php
<?php
    define('YPF_CMD', true);
    define('YPF_PATH', realpath(dirname(__FILE__).'/..'));
    define('APP_PATH', realpath(getcwd()));
    define('WWW_PATH', APP_PATH.'/www');

    if (stripos(APP_PATH, YPF_PATH) !== false)
        die("command not allowed on this path\n");

    try {
        require realpath(dirname(__FILE__).'/../loader.php');
    } catch (NoApplicationError $error) {
    }

    function run_command($name, $parameters = array()) {
        $command = YPFCommand::get($name);
        if ($command === false)
            die ("invalid ypf installation\n");

        exit($command->run($parameters));
    }


    if ($argc < 2)
        run_command('help');
    else {
        $parameters = $argv;
        array_shift($parameters);
        $name = array_shift($parameters);
        run_command($name, $parameters);
    }
?>
